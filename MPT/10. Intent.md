Intent is a messaging object used for communication between Android components. It requests an action from another app component like starting an activity, service, or delivering a broadcast.  

In the Android world, components (Activities, Services) don't talk to each other directly. Instead, they create an Intent (an envelope), put some instructions and data inside it, and hand it to the Android OS. The OS then delivers that message to the correct destination.

It is used for:
- **Starting an Activity:** (e.g., clicking a button to go from Screen A to Screen B).
- **Starting a Service:** (e.g., telling the app to start downloading a file in the background).
- **Broadcasting a Message:** (e.g., The system telling all apps: "The battery is low" or "WiFi is connected").

Intents are critical attack vectors for inter-process communication vulnerabilities.


## Types of Intents
#### 1.Explicit Intent

You specify exactly which component should receive the intent by providing the full class name.
```JAVA
Intent intent = new Intent(this, LoginActivity.class);
startActivity(intent);
```

Here the app knows exactly where to send the intent. Only LoginActivity will receive it. This is secure because no other app can intercept.

#### Implicit Intent

You only specify what action you want. Any app that can handle this action can respond.
```java
Intent intent = new Intent(Intent.ACTION_VIEW);
intent.setData(Uri.parse("https://example.com"));
startActivity(intent);
```

**Here multiple browsers can respond like Chrome, Firefox, or a malicious app pretending to be a browser. This is where security problems begin.**

#### Components of Intent

1. **Action**
Defines what operation to perform.
```
intent.setAction("android.intent.action.VIEW");
intent.setAction("android.intent.action.SEND");
intent.setAction("com.target.app.TRANSFER_MONEY");
```

2. **Data**
Contains URI that the action operates on.
```
intent.setData(Uri.parse("content://contacts/1"));
intent.setData(Uri.parse("file:///sdcard/secret.pdf"));
intent.setData(Uri.parse("myapp://payment?amount=100"));
```

3. **Extras**
Key-value pairs carrying additional data.
```
intent.putExtra("username", "admin");
intent.putExtra("amount", 10000);
intent.putExtra("isAdmin", true);
```

4. **Flags**
Modify how intent is handled.
```
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
```
## How Components Receive Intents
In AndroidManifest.xml, components declare what intents they can handle using intent-filter:

```
<activity android:name=".ShareActivity"
          android:exported="true">
    <intent-filter>
        <action android:name="android.intent.action.SEND"/>
        <category android:name="android.intent.category.DEFAULT"/>
        <data android:mimeType="text/plain"/>
    </intent-filter>
</activity>
```

This ShareActivity says it can handle SEND action for plain text. When any app sends text using implicit intent, this activity can receive it.


## Exported vs Non-Exported

**exported="true"**
Other apps can send intents to this component.

```
<activity android:name=".PublicActivity"
          android:exported="true">
```

Any app on the device can start this activity. This is an attack surface.

**exported="false"**
Only the same app can send intents to this component.

```
<activity android:name=".PrivateActivity"
          android:exported="false">
```

Other apps cannot start this activity. This is secure.

==If a component has intent-filter and targets SDK below 31, it becomes exported by default even without specifying. This catches many developers off guard.==

## Finding Vulnerable Components
Step 1: Decompile APK
use JDX
Step 2: Search for Exported Components
```
grep -r "exported=\"true\"" AndroidManifest.xml
```

Step 3: Search for Intent Filters
```
grep -r "intent-filter" AndroidManifest.xml
```

Step 4: Search for Deep Link Schemes
```
grep -r "android:scheme" AndroidManifest.xml
```

Step 5: List Attack Surface Using Drozer
```
drozer console connect
run app.package.attacksurface com.target.app
```

output:
Attack Surface:
```
  4 activities exported
  2 broadcast receivers exported
  1 content providers exported
  1 services exported
```

Step 6: Get Details of Exported Activities
```
run app.activity.info -a com.target.app
```

## Vulnerabilities in Intents
1: Exported Activity Without Protection
2: Sensitive Data in Extras Without Validation
3: Intent Hijacking
4: Unvalidated Deep Links
5: Path Traversal via Intent
6: SQL Injection via Intent
7: Pending Intent Vulnerability
8: Broadcast Injection